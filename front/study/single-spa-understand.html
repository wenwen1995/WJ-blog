<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>WJ-blog</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/WJ-blog/logo.jpg">
    <meta name="description" content="æˆ‘çš„ä¸ªäººç½‘ç«™">
    
    <link rel="preload" href="/WJ-blog/assets/css/0.styles.2ad60580.css" as="style"><link rel="preload" href="/WJ-blog/assets/js/app.c05677e7.js" as="script"><link rel="preload" href="/WJ-blog/assets/js/2.505982ba.js" as="script"><link rel="preload" href="/WJ-blog/assets/js/12.44ae18c6.js" as="script"><link rel="prefetch" href="/WJ-blog/assets/js/10.8fcddb8a.js"><link rel="prefetch" href="/WJ-blog/assets/js/11.d6859bc4.js"><link rel="prefetch" href="/WJ-blog/assets/js/13.52e75d4d.js"><link rel="prefetch" href="/WJ-blog/assets/js/14.97d5cf08.js"><link rel="prefetch" href="/WJ-blog/assets/js/15.afa4769b.js"><link rel="prefetch" href="/WJ-blog/assets/js/16.6862d082.js"><link rel="prefetch" href="/WJ-blog/assets/js/17.41dc651b.js"><link rel="prefetch" href="/WJ-blog/assets/js/18.384b9c12.js"><link rel="prefetch" href="/WJ-blog/assets/js/19.c1101422.js"><link rel="prefetch" href="/WJ-blog/assets/js/20.8e6122ab.js"><link rel="prefetch" href="/WJ-blog/assets/js/3.ff4912f2.js"><link rel="prefetch" href="/WJ-blog/assets/js/4.0f1e9ae3.js"><link rel="prefetch" href="/WJ-blog/assets/js/5.9dae0359.js"><link rel="prefetch" href="/WJ-blog/assets/js/6.9a384a25.js"><link rel="prefetch" href="/WJ-blog/assets/js/7.acacec87.js"><link rel="prefetch" href="/WJ-blog/assets/js/8.f0b331f1.js"><link rel="prefetch" href="/WJ-blog/assets/js/9.161c34cf.js">
    <link rel="stylesheet" href="/WJ-blog/assets/css/0.styles.2ad60580.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/WJ-blog/" class="home-link router-link-active"><!----> <span class="site-name">WJ-blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/WJ-blog/front/introduction.html" class="nav-link">
  å‰ç«¯
</a></div><div class="nav-item"><a href="/WJ-blog/algorithm/study-leetcode.html" class="nav-link">
  ç®—æ³•é¢˜åº“
</a></div><div class="nav-item"><a href="/WJ-blog/life/introduction.html" class="nav-link">
  ç”Ÿæ´»
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/WJ-blog/front/introduction.html" class="nav-link">
  å‰ç«¯
</a></div><div class="nav-item"><a href="/WJ-blog/algorithm/study-leetcode.html" class="nav-link">
  ç®—æ³•é¢˜åº“
</a></div><div class="nav-item"><a href="/WJ-blog/life/introduction.html" class="nav-link">
  ç”Ÿæ´»
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>å‰ç«¯å­¦ä¹ </span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/WJ-blog/front/introduction.html" class="sidebar-link">ä»‹ç»</a></li><li><a href="/WJ-blog/front/study/single-spa-understand.html" aria-current="page" class="active sidebar-link">å…³äºsingle-spaçš„ç†è§£å’Œå°å®æˆ˜</a></li><li><a href="/WJ-blog/front/study/typescript-about-interface-understand.html" class="sidebar-link">TYPESCRIPT å…³äºinterfaceç†è§£</a></li><li><a href="/WJ-blog/front/study/css3 transform, transform-origin usage.html" class="sidebar-link">css3 transform, transform-origin ç”¨æ³•</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>å·¥ä½œé‡åˆ°çš„é—®é¢˜</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/WJ-blog/front/work/realize-iframe-and-window.postMessage.html" class="sidebar-link">è®¤è¯†iframeå’Œwindow.postMessageçš„ä½¿ç”¨</a></li><li><a href="/WJ-blog/front/work/vue-admin keep-alive-multiple-router-can't-cathe.html" class="sidebar-link">vue ä½¿ç”¨keep-alive ä¸‰çº§ä»¥ä¸Šçš„è·¯ç”±ï¼Œæ— æ³•ç¼“å­˜é—®é¢˜</a></li><li><a href="/WJ-blog/front/work/scrollIntoView VS scrollIntoViewIfNeeded.html" class="sidebar-link">scrollIntoView VS scrollIntoViewIfNeededã€çˆ¬å‘</a></li><li><a href="/WJ-blog/front/work/circle-progress-by-css3.html" class="sidebar-link">é™æ€ç¯å½¢è¿›åº¦æ¡css3å®ç°</a></li><li><a href="/WJ-blog/front/work/circle-progress-by-svg.html" class="sidebar-link">é™æ€ç¯å½¢è¿›åº¦æ¡svgå®ç°</a></li></ul></section></li><li><a href="/WJ-blog/algorithm/study-leetcode.html" class="sidebar-link">åˆ·leetcodeéƒ¨åˆ†ç¬”è®°æ€»ç»“</a></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>ç”Ÿæ´»æ‚è®°</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/WJ-blog/life/introduction.html" class="sidebar-link">ä»‹ç»</a></li><li><a href="/WJ-blog/life/lifeDaily/2021-7-7-life.html" class="sidebar-link">2021å¹´7æœˆ7æ—¥ç”Ÿæ´»ç¬”è®°</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><p><font color="blue" size="24">single-spa </font></p> <p>èµ·å› æ˜¯çœ‹äº†ä¸€ä¸‹æ˜é‡‘çš„è¿™ç¯‡é“¾æ¥; [æ¯æ—¥ä¼˜é²œä¾›åº”é“¾å‰ç«¯å›¢é˜Ÿå¾®å‰ç«¯æ”¹é€ ](https://juejin.im/post/5d7f702ce51d4561f777e258, è®²æœ€ç»ˆå°†å¤šä¸ªç‹¬ç«‹çš„å°é¡¹ç›®ï¼Œåˆ©ç”¨single-spaæ¡†æ¶çš„æ–¹æ³•(å³lç±»ä¼¼äºå¾®æœåŠ¡)) æ•´åˆæˆä¸€ä¸ªå¤§é¡¹ç›®ã€‚è®²çš„å¾ˆä¸é”™</p> <ul><li>é€‚ç”¨åœºæ™¯ï¼šé¡¹ç›®åºå¤§ï¼Œå¤šä¸ªå­é¡¹ç›®æ•´åˆåœ¨ä¸€ä¸ªå¤§çš„é¡¹ç›®ä¸­ã€‚å³ä½¿å­é¡¹ç›®çš„æ‰€ç”¨çš„æŠ€æœ¯æ ˆä¸åŒï¼Œæ¯”å¦‚vue,react, angularæœ‰ç›¸åº”çš„single-spaçš„è½®å­ï¼Œå¯ä»¥è¿›è¡Œæ•´åˆã€‚</li></ul> <ul><li><p>ä¸é€‚ç”¨äºï¼š
ï¼ˆ1ï¼‰&lt; ie9 ä»¥ä¸‹çš„ç‰ˆæœ¬
ï¼ˆ2ï¼‰é¡¹ç›®ä¸å¤§å‹ï¼Œä¸éœ€è¦åˆ‡åˆ†
ï¼ˆ3ï¼‰é¡¹ç›®åº”ç”¨ä¹‹é—´æ²¡æœ‰å¿…ç„¶çš„è”ç³»</p></li> <li><p>ä¼˜ç‚¹ï¼š
(1) è‹¥å¤šä¸ªåº”ç”¨ä¹‹é—´å…¬ç”¨ä¸€äº›å…±æœ‰çš„éƒ¨åˆ†ï¼Œå¯å°†å…¶æŠ½ç¦»å‡ºæ¥ï¼Œåœ¨æœ€ç»ˆçš„æ‰“åŒ…è¿‡ç¨‹ä¸­æ˜æ˜¾çš„ä½“ç§¯ç¼©å°ã€‚è¿è¡ŒåŠ å¿«ã€‚
(2) ä¸åŒçš„åº”ç”¨ä¹‹é—´ï¼Œç”±ä¸€ä¸ªè·³è½¬åˆ°å¦ä¸€ä¸ªæ—¶ï¼Œåœ¨ä¸æ¶‰åŠåº”ç”¨ä¹‹é—´çŠ¶æ€äº¤äº’æ—¶ï¼Œä¸ç”¨è€ƒè™‘é‡å†™ä¹‹ç±»çš„é—®é¢˜ï¼Œåªéœ€é…ç½®å¥½å¯¹åº”çš„spaï¼Œå°±å¯ä»¥è¿›è¡Œåˆ‡æ¢</p></li> <li><p>è‡ªèº«ç†è§£ï¼š
åœ¨å¨˜èƒé‡Œï¼Œç†Šå¤§ã€ç†ŠäºŒã€ç†Šä¸‰...ç†Šn éƒ½æ˜¯ç†Šå¦ˆå¦ˆçš„å®å®ã€‚åšbè¶…æ—¶éƒ½èƒ½çœ‹åˆ°å„ä¸ªç†Šå®å®çš„è¡¨ç°å’Œå„è‡ªçš„è¡Œä¸ºï¼Œä½†æ˜¯æ€»ä½“ä¸Šï¼Œå®ƒä»¬éƒ½åœ¨ç†Šå¦ˆå¦ˆçš„è‚šå­é‡Œã€‚</p> <p>è€Œç†Šå¦ˆå¦ˆå°±å±äº è¿™ä¸ªsingle-spa åŒ…è£…åçš„å¹³å°ï¼Œ è€Œæ¯ä¸ªç†Šå®å®éƒ½æ˜¯ç‹¬ç«‹çš„ï¼Œæœ‰å„è‡ªçš„è¡Œä¸ºçŠ¶æ€</p></li> <li><p>æ›´å¥½çš„ç†è§£ï¼Œå¯ä»¥å‚è€ƒè¿™ç¯‡é“¾æ¥ï¼š <a href="https://juejin.im/post/5a0ea4ec6fb9a0450407725c" target="_blank" rel="noopener noreferrer"><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li></ul> <p><a href="https://single-spa.js.org/" target="_blank" rel="noopener noreferrer">single-spa  githubå®˜ç½‘<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <font color="red" size="3">æ³¨ï¼š è‹±æ–‡ä¸é”™çš„åŒå­¦å¯ä»¥å¥½å¥½è¯»è¯»å®˜ç½‘çš„æ•™ç¨‹æ–‡ç« ï¼Œå†™çš„è¶…çº§å¥½ï¼Œæœ‰è¯¦ç»†çš„æ•™ç¨‹ã€apiå’Œå‚æ•°æ–‡æ¡£</font></p> <p><a href="https://github.com/joeldenning/coexisting-vue-microfrontends" target="_blank" rel="noopener noreferrer">single-spa-vueçš„ä¾‹å­<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><font color="red" size="3">æ³¨ï¼šè¯¥ä¾‹ä¸­æ˜¯å…¨éƒ¨ä»¥vueä¸ºå•åº”ç”¨ï¼Œç»„åˆèµ·æ¥çš„ä¸€ä¸ªsingle-spaåœºæ™¯, å»ºè®®cloneä¸‹æ¥åè·‘ä¸€éï¼Œå¹¶å‚è€ƒæ–‡æ¡£æ·±åˆ»ç†è§£å…¶ä¸­å«ä¹‰</font></p> <p>å¦‚ä¸‹æ‰€ç¤ºï¼š</p> <p>(1)é»‘è‰²éƒ¨åˆ†æ¯ä¸€ä¸ªéƒ½æ˜¯ä¸€ä¸ªvueå•é¡µåº”ç”¨ï¼Œæœ€å¤–å±‚æ©™è‰²çš„åŒ…è£¹å™¨å°†ä»–ä»¬æ³¨å†Œå¼€å¯åŒ…è£¹è¿›æ¥
(2)navvar åº”ç”¨é€šè¿‡vue-routerçš„æ–¹å¼ï¼Œå¯ä»¥è·³è½¬åˆ°app1åº”ç”¨æˆ–è€…app2åº”ç”¨</p> <p><img src="https://wrapper-1258672812.cos.ap-chengdu.myqcloud.com/19-9-20/1.png" alt="æ•´ä¸ªdemoçš„ç»“æ„ç†è§£"></p> <p>åˆ†æä¸€ä¸‹å•åº”ç”¨navbar, app1, app2ã€‚å› ä¸ºä»–ä»¬æ–‡ä»¶ç»“æ„éƒ½æ˜¯ç›¸åŒçš„ï¼Œæ‰€ä»¥å°±çœ‹ä¸‹app1 å’Œapp2å¥½å•¦ï¼Œå¦‚ä¸‹ï¼š</p> <p><img src="https://wrapper-1258672812.cos.ap-chengdu.myqcloud.com/19-9-20/2.png" alt="ç›®å½•ç»“æ„å›¾"></p> <p>æŒ‰ç…§å®˜ç½‘ä¾‹å­å®‰è£…å¥½å¯¹åº”çš„ä¾èµ–åï¼ŒæŸ¥çœ‹æ–‡ä»¶å¤¹ä¸­çš„å†…å®¹ã€‚</p> <h4 id="_1-å…ˆçœ‹package-json"><a href="#_1-å…ˆçœ‹package-json" class="header-anchor">#</a> 1.å…ˆçœ‹package.json</h4> <p><strong>é™¤äº†nameå’Œç›‘å¬çš„ç«¯å£ä¸ä¸€æ ·</strong>ï¼Œå…¶ä»–éƒ½ä¸€æ ·</p> <p><img src="https://wrapper-1258672812.cos.ap-chengdu.myqcloud.com/19-9-20/3.png" alt="package.jsonå›¾"></p> <p>ç”±äºnavbarã€app1ã€app2çš„ç›®å½•ç»“æ„åŸºæœ¬ä¸€è‡´ï¼Œå°±åªè¯´app1çš„å§ï¼Œ
app1 çš„ç›®å½•ç»“æ„å¦‚ä¸‹ï¼š</p> <p><img src="https://wrapper-1258672812.cos.ap-chengdu.myqcloud.com/19-9-20/4.png" alt="app1 çš„ç›®å½•ç»“æ„"></p> <h4 id="_2-vue-config-jsæ˜¯è¿™æ ·å†™çš„"><a href="#_2-vue-config-jsæ˜¯è¿™æ ·å†™çš„" class="header-anchor">#</a> 2.vue.config.jsæ˜¯è¿™æ ·å†™çš„:</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">chainWebpack</span><span class="token operator">:</span> <span class="token parameter">config</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    config<span class="token punctuation">.</span>devServer<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'inline'</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
    config<span class="token punctuation">.</span>devServer<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'hot'</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
    config<span class="token punctuation">.</span><span class="token function">externals</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'vue'</span><span class="token punctuation">,</span> <span class="token string">'vue-router'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  filenameHashing<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>ä¸Šè¿°é…ç½®è¡¨æ˜:
* çƒ­åŠ è½½é…ç½®ä¸­ï¼š å…³é—­å½“å‰åº”ç”¨çš„ä»£ç æ”¹å˜å°±åŠ è½½çš„åŠŸèƒ½ï¼Œå…³é—­çƒ­æ›´æ–°ï¼Œ
* å…ˆå°†vueå’Œvue-routerçš„ä¾èµ–æš´éœ²å‡ºå»ï¼Œå†åœ¨æœ€ç»ˆçš„root-html-fileçš„index.htmlä¸­è¿›è¡Œé…ç½®ï¼Œç›®çš„æ˜¯ <strong>ä¸ºäº†å¤šä¸ªå•åº”ç”¨ä¹‹é—´ç›¸åŒçš„ä¾èµ–ï¼Œå®ƒä»¬çš„ç‰ˆæœ¬å·åº”è¯¥ä¿æŒä¸€è‡´ï¼Œvueå®ä¾‹åº”è¯¥ä¿æŒä¸€è‡´</strong>
* å…³é—­æœ€ç»ˆæ‰“åŒ…ç”Ÿæˆçš„æ–‡ä»¶åé¢å¸¦æœ‰hashç </p> <h4 id="_3-babel-config-js"><a href="#_3-babel-config-js" class="header-anchor">#</a> 3. babel.config.js,</h4> <p>å†™æˆè¿™æ ·æ˜¯ä¸ºäº†è®©æµè§ˆå™¨æ”¯æŒæœ€æ–°çš„esè¯­æ³•ï¼Œæ¯”å¦‚æ‰©å±•è¿ç®—ç¬¦ï¼ŒåŠ¨æ€importï¼Œè½¬åŒ–vue jsx æˆ–è€…è½¬åŒ–generatorå’Œasync/awaitè¯­æ³•ç³–</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  presets<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">'@vue/app'</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="_4-å…¥å£æ–‡ä»¶main-js-æ”¹å˜"><a href="#_4-å…¥å£æ–‡ä»¶main-js-æ”¹å˜" class="header-anchor">#</a> 4.å…¥å£æ–‡ä»¶main.js æ”¹å˜</h4> <p><font color="red" size="3">ä¸€èˆ¬çš„vueåº”ç”¨,</font>  å…¥å£æ–‡ä»¶main.js é…ç½®å¦‚ä¸‹ï¼š</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">import</span> App <span class="token keyword">from</span> <span class="token string">'./App'</span>
<span class="token keyword">import</span> router <span class="token keyword">from</span> <span class="token string">'./router'</span>

Vue<span class="token punctuation">.</span>config<span class="token punctuation">.</span>productionTip <span class="token operator">=</span> <span class="token boolean">false</span>

<span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  el<span class="token operator">:</span> <span class="token string">'#app'</span><span class="token punctuation">,</span>
  router<span class="token punctuation">,</span>
  components<span class="token operator">:</span> <span class="token punctuation">{</span> App <span class="token punctuation">}</span><span class="token punctuation">,</span>
  template<span class="token operator">:</span> <span class="token string">'&lt;App/&gt;'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p><strong>src/main.js ï¼Œæ­¤æ–‡ä»¶ä¸ºåº”ç”¨çš„å…¥å£æ–‡ä»¶é…ç½®å¦‚ä¸‹ï¼š</strong></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token string">'./set-public-path'</span>
<span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">'vue'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> App <span class="token keyword">from</span> <span class="token string">'./App.vue'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> router <span class="token keyword">from</span> <span class="token string">'./router'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> singleSpaVue <span class="token keyword">from</span> <span class="token string">'single-spa-vue'</span><span class="token punctuation">;</span>

Vue<span class="token punctuation">.</span>config<span class="token punctuation">.</span>productionTip <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> vueLifecycles <span class="token operator">=</span> <span class="token function">singleSpaVue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  Vue<span class="token punctuation">,</span>
  appOptions<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">render</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">h</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">h</span><span class="token punctuation">(</span>App<span class="token punctuation">)</span><span class="token punctuation">,</span>
    router<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//åº”ç”¨åˆå§‹</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> bootstrap <span class="token operator">=</span> vueLifecycles<span class="token punctuation">.</span>bootstrap<span class="token punctuation">;</span>
<span class="token comment">//åº”ç”¨æŒ‚è½½</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> mount <span class="token operator">=</span> vueLifecycles<span class="token punctuation">.</span>mount<span class="token punctuation">;</span>
<span class="token comment">//åº”ç”¨å¸è½½</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> unmount <span class="token operator">=</span> vueLifecycles<span class="token punctuation">.</span>unmount<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>å…¶ä¸­è¿™é‡Œçš„singleSpaVue(opts)é‡Œé¢çš„å‚æ•°å’Œè¡¨ç¤ºçš„å«ä¹‰åˆ†åˆ«æ˜¯ï¼š</p> <ul><li>Vue,<strong>ï¼ˆå¿…é¡»å‚æ•°ï¼‰</strong>ï¼ŒVueå¯¹è±¡ï¼Œé€šè¿‡importæš´éœ²æˆ–è€…é€šè¿‡require('vue')çš„æ–¹å¼</li> <li>appOptions,<strong>ï¼ˆå¿…é¡»å‚æ•°ï¼‰</strong>ï¼Œæ˜¯ç”¨äºåˆ›å»ºä½ çš„vueåº”ç”¨çš„ä¸€ä¸ªå®ä¾‹å¯¹è±¡ï¼Œé€šè¿‡new Vue(appOptions)çš„æ–¹å¼åˆ›å»ºã€‚
<font color="red" size="3">æ³¨æ„ï¼šå¦‚æœæ²¡æœ‰ç»™appOptionsæä¾›ä¸€ä¸ªæŒ‚è½½çš„èŠ‚ç‚¹elå…ƒç´ ä¸Šï¼Œé‚£å®ƒåˆ›å»ºä¸€ä¸ªdivï¼Œä½œä¸ºä¸€ä¸ªé»˜è®¤çš„å®¹å™¨æ’å…¥åˆ°ä½ çš„vueåº”ç”¨domä¸­</font></li> <li>loadRootComponentï¼ˆå¯é€‰å‚æ•°ï¼Œå¯æ›¿ä»£appOptionsä¸­çš„renderï¼‰,è§£æä½ çš„æ ¹ç»„ä»¶å¹¶è¿”å›ä¸€ä¸ªpromiseå¯¹è±¡ã€‚è¿™ä¸ªé€‚åˆäºæ‡’åŠ è½½</li></ul> <h4 id="_5-src-set-public-path-jsä¹¦å†™"><a href="#_5-src-set-public-path-jsä¹¦å†™" class="header-anchor">#</a> 5.src/set-public-path.jsä¹¦å†™</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code>__webpack_public_path__ <span class="token operator">=</span> window<span class="token punctuation">.</span><span class="token function">getPublicPath</span><span class="token punctuation">(</span><span class="token string">'app1'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>__webpack_public_path__æ˜¯webpackçš„outputé…ç½®ä¸­çš„publickPathå‚æ•°çš„å¦å¤–ä¸€ç§é…ç½®ï¼Œå®ƒæ˜¯webpackæš´éœ²çš„ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œè¡¨ç¤ºè®¾ç½®è¿è¡Œçš„publicPath</strong></p> <p>è¿™é‡Œwindow.getPublicPathï¼Œæ˜¯ä¸ªæ–¹æ³•ï¼Œå®šä¹‰åœ¨æœ€å¤–å±‚çš„root-html-fileä¸‹çš„htmlçš„scriptæ ‡ç­¾ä¸­ï¼Œç”¨æ¥è·å–å½“å‰åº”ç”¨çš„publicPathæ˜¯ä»€ä¹ˆã€‚</p> <p>å¯èƒ½æœ‰åŒå­¦å¾ˆå¥½å¥‡äº†ï¼Œä¸ºå•¥ä¸Šè¿°çš„æ¯ä¸ªvueåº”ç”¨ï¼Œéƒ½æ²¡æœ‰webpackçš„é…ç½®æ–‡ä»¶ï¼Œä¹Ÿè¦è®¾ç½®ä¸Šè¿°çš„publicPathè·¯å¾„ï¼Ÿ
è¿™æ˜¯å› ä¸ºä½¿ç”¨äº†vue/cli-service æ’ä»¶ï¼Œå®ƒé‡Œé¢å°è£…äº†webpack, å¯åŠ¨æ¯ä¸ªåº”ç”¨çš„å‘½ä»¤æ˜¯è¿™æ ·å†™çš„ï¼š</p> <p><code>&quot;serve&quot;: &quot;vue-cli-service serve --port 8081&quot;,</code></p> <p>å®é™…ä¸Šï¼š
<img src="https://wrapper-1258672812.cos.ap-chengdu.myqcloud.com/19-9-20/5.png" alt=""></p> <h4 id="_6-router-jsã€app-vueã€views-ç­‰æ–‡ä»¶éƒ½è·Ÿæˆ‘ä»¬å†™vueæ–‡ä»¶ä¿æŒä¸€è‡´-ä¸åšç»†è®²ã€‚"><a href="#_6-router-jsã€app-vueã€views-ç­‰æ–‡ä»¶éƒ½è·Ÿæˆ‘ä»¬å†™vueæ–‡ä»¶ä¿æŒä¸€è‡´-ä¸åšç»†è®²ã€‚" class="header-anchor">#</a> 6. router.jsã€App.vueã€views/ ç­‰æ–‡ä»¶éƒ½è·Ÿæˆ‘ä»¬å†™vueæ–‡ä»¶ä¿æŒä¸€è‡´ï¼Œä¸åšç»†è®²ã€‚</h4> <p>å†çœ‹æˆ‘ä»¬æœ€ç»ˆèåˆçš„åº”ç”¨<strong>root-html-file</strong>, ç›®å½•æ–‡ä»¶å¦‚ä¸‹ï¼š</p> <p><img src="https://wrapper-1258672812.cos.ap-chengdu.myqcloud.com/19-9-20/6.png" alt="root-html-fileç›®å½•å›¾"></p> <h5 id="_7-package-jsonå¾ˆç®€å•-ä»£ç å¦‚ä¸‹-serveæ˜¯ä¸ªnodeæœåŠ¡æ’ä»¶-å°†æˆ‘ä»¬çš„é¡¹ç›®å±•ç¤ºåœ¨æµè§ˆå™¨ä¸Š"><a href="#_7-package-jsonå¾ˆç®€å•-ä»£ç å¦‚ä¸‹-serveæ˜¯ä¸ªnodeæœåŠ¡æ’ä»¶-å°†æˆ‘ä»¬çš„é¡¹ç›®å±•ç¤ºåœ¨æµè§ˆå™¨ä¸Š" class="header-anchor">#</a> 7.package.jsonå¾ˆç®€å•ï¼Œä»£ç å¦‚ä¸‹ï¼Œserveæ˜¯ä¸ªnodeæœåŠ¡æ’ä»¶ï¼Œå°†æˆ‘ä»¬çš„é¡¹ç›®å±•ç¤ºåœ¨æµè§ˆå™¨ä¸Šï¼Œ</h5> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token punctuation">{</span>
  <span class="token string">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;root-html-file&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;serve&quot;</span><span class="token operator">:</span> <span class="token string">&quot;serve -s -l 5000&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string">&quot;devDependencies&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;serve&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^11.1.0&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h4 id="_8-root-html-fileä¸­çš„index-html"><a href="#_8-root-html-fileä¸­çš„index-html" class="header-anchor">#</a> 8. root-html-fileä¸­çš„index.html</h4> <p>ä¸»è¦çš„æ˜¯è¿™ä¸ªindex.htmlæ–‡ä»¶ï¼Œé‡Œé¢è¿™äº›ä¸œè¥¿éƒ½å¾ˆé‡è¦ï¼Œ</p> <p>ä¸‹é¢æ¥æŒ‘ä¸»è¦çš„ä¸€ä¸€è¯´æ˜ï¼Œ</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">&lt;</span>script type<span class="token operator">=</span><span class="token string">&quot;systemjs-importmap&quot;</span><span class="token operator">&gt;</span>
      <span class="token punctuation">{</span>
        <span class="token string">&quot;imports&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token string">&quot;navbar&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://localhost:8080/app.js&quot;</span><span class="token punctuation">,</span>
          <span class="token string">&quot;app1&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://localhost:8081/app.js&quot;</span><span class="token punctuation">,</span>
          <span class="token string">&quot;app2&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://localhost:8082/app.js&quot;</span><span class="token punctuation">,</span>
          <span class="token string">&quot;single-spa&quot;</span><span class="token operator">:</span> <span class="token string">&quot;https://cdnjs.cloudflare.com/ajax/libs/single-spa/4.3.7/system/single-spa.min.js&quot;</span><span class="token punctuation">,</span>
          <span class="token string">&quot;vue&quot;</span><span class="token operator">:</span> <span class="token string">&quot;https://cdn.jsdelivr.net/npm/vue@2.6.10/dist/vue.js&quot;</span><span class="token punctuation">,</span>
          <span class="token string">&quot;vue-router&quot;</span><span class="token operator">:</span> <span class="token string">&quot;https://cdn.jsdelivr.net/npm/vue-router@3.0.7/dist/vue-router.min.js&quot;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>è¿™é‡Œæ˜¯ä½¿ç”¨<strong>systemjs</strong>ï¼Œæ˜¯ä¸€ä¸ªè¿è¡Œäºæµè§ˆå™¨ç«¯çš„æ¨¡å—åŠ è½½å™¨ï¼Œå°†æˆ‘ä»¬æ•´ä¸ªåº”ç”¨æ‰€éœ€è¦çš„jsæ–‡ä»¶ï¼Œéƒ½ä»¥importsçš„å½¢å¼å¼•å…¥è¿›æ¥</p> <p>å†æ¥çœ‹bodyä¸­çš„scriptä»£ç ï¼Œè¿™é‡Œé¢æ¯”è¾ƒæ ¸å¿ƒã€‚ä¸€ä¸€åˆ†æä¸‹ï¼Œæ€»ä½“ä»£ç å¦‚ä¸‹ï¼š</p> <p><img src="https://wrapper-1258672812.cos.ap-chengdu.myqcloud.com/19-9-20/7.png" alt="æ ¸å¿ƒä»£ç "></p> <p><font color="lightblue" size="3">ç¬¬ä¸€éƒ¨åˆ†ï¼š</font></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> originalResolve <span class="token operator">=</span> System<span class="token punctuation">.</span>resolve
 <span class="token keyword">var</span> moduleMap <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
 System<span class="token punctuation">.</span><span class="token function-variable function">resolve</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">originalResolve</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> arguments<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">resolved</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    moduleMap<span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> resolved<span class="token punctuation">;</span>
    <span class="token keyword">return</span> resolved<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>ä¸Šè¿°ä»£ç æ˜¯å°†å¯¼å…¥çš„æ¨¡å—æ–‡ä»¶ï¼Œé€šè¿‡system.resolveè§£æå‡ºæ¥ï¼Œå½¢æˆä¸€ä¸ª <strong>moduleMapå¯¹è±¡</strong>ã€‚</p> <p><strong>è¿™é‡Œç”±äºé»˜è®¤è¾“å…¥localhost: 5000,åŠ è½½çš„åªæœ‰navbaråº”ç”¨å’Œsingle-spaæ’ä»¶ï¼Œvueæ’ä»¶ã€vue-routeræ’ä»¶ã€‚</strong></p> <p><img src="https://wrapper-1258672812.cos.ap-chengdu.myqcloud.com/19-9-20/8.png" alt="å›¾ç¤º"></p> <p>app1åº”ç”¨å’Œapp2åº”ç”¨æ˜¯ç‚¹å‡»ä¸Šè¿°é“¾æ¥ï¼Œé€šè¿‡vue-routerçš„å½¢å¼è¿›å…¥ï¼Œå¹¶åŠ è½½å¯¹åº”çš„åº”ç”¨ï¼Œæ‰€ä»¥</p> <p>ç»“æœå¾—åˆ°éªŒè¯ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œä¸€å¼€å§‹çš„localhost:5000æ—¶ï¼Œæ‰“å°å…¶ä¸­çš„moduleMapä¿¡æ¯ï¼Œæ˜¾ç¤ºå¦‚ä¸‹
<img src="https://wrapper-1258672812.cos.ap-chengdu.myqcloud.com/19-9-20/9.png" alt="ç»“æœ"></p> <p><strong>è¿›å…¥app1åº”ç”¨æ—¶, ç”±äºvue-routeré…ç½®çš„ä½œç”¨ï¼Œé»˜è®¤åœ°å€æ ååŠ äº†ä¸ª/app1,ä½†å®é™…åŠ è½½çš„app1æ˜¯è·‘åœ¨localhost: 8081ä¸Šçš„ï¼Œ</strong></p> <p><img src="https://wrapper-1258672812.cos.ap-chengdu.myqcloud.com/19-9-20/10.png" alt="å›¾ç¤º"></p> <p>localhost:5000/app1æ—¶çš„moduleMapä¿¡æ¯ï¼š
<img src="https://wrapper-1258672812.cos.ap-chengdu.myqcloud.com/19-9-20/11.png" alt="ç»“æœ"></p> <p><strong>è¿›å…¥app2åº”ç”¨æ—¶ï¼ŒåŒç†åœ°å€æ ååŠ äº†ä¸ª/app2,ä½†å®é™…åŠ è½½çš„app2æ˜¯è·‘åœ¨localhost: 8082ä¸Šçš„ï¼Œ</strong></p> <p><img src="https://wrapper-1258672812.cos.ap-chengdu.myqcloud.com/19-9-20/12.png" alt="å›¾ç¤º"></p> <p>localhost:5000/app2æ—¶çš„moduleMapä¿¡æ¯ï¼š
<img src="https://wrapper-1258672812.cos.ap-chengdu.myqcloud.com/19-9-20/13.png" alt="ç»“æœ"></p> <p><font color="purple" size="4">å³ä¸ªäººç†è§£ï¼š è¿™æ ·åšåˆ°äº†è®¿é—®ä¸åŒçš„åº”ç”¨ï¼Œå¯¹åº”çš„æ¨¡å—æŒ‰éœ€åŠ è½½ï¼ŒèŠ‚çœå¤šä½™çš„è¯·æ±‚å’Œå¸¦å®½ï¼Œæé«˜åŠ è½½æ•ˆç‡ã€‚</font></p> <p><font color="lightblue" size="3">ç¬¬äºŒéƒ¨åˆ†ï¼š </font></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>window<span class="token punctuation">.</span><span class="token function-variable function">getPublicPath</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">const</span> url <span class="token operator">=</span> moduleMap<span class="token punctuation">[</span>name<span class="token punctuation">]</span>
   console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'url ---?'</span><span class="token punctuation">,</span>url<span class="token punctuation">)</span>
   <span class="token keyword">if</span> <span class="token punctuation">(</span>url<span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token keyword">let</span> index <span class="token operator">=</span> url<span class="token punctuation">.</span><span class="token function">lastIndexOf</span><span class="token punctuation">(</span><span class="token string">'/js'</span><span class="token punctuation">)</span>
     <span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      index <span class="token operator">=</span> url<span class="token punctuation">.</span><span class="token function">lastIndexOf</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span>
     <span class="token punctuation">}</span>
     index<span class="token operator">++</span>
    <span class="token keyword">return</span> url<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> index<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
   <span class="token keyword">throw</span> <span class="token function">Error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Could not find url for module '</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">'</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
 <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p><em>è¿™é‡Œæ˜¯é€šè¿‡æ‹¿åˆ°moduleMapé”®å€¼å¯¹ä¸­çš„å€¼ï¼Œå³ç°åœ¨è¯·æ±‚è®¿é—®çš„urlï¼Œç”¨æ¥è®¾ç½®å½“å‰åº”ç”¨è¿è¡Œæ—¶çš„publicPathï¼ä¸å¾—ä¸è¯´æ˜¯å¾ˆå·§å¦™çš„ä¸€ç§æ–¹å¼å•Š~</em></p> <p><font color="lightblue" size="3">ç¬¬ä¸‰éƒ¨åˆ†ï¼š </font></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code> Promise<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">[</span>System<span class="token punctuation">.</span><span class="token function">import</span><span class="token punctuation">(</span><span class="token string">'single-spa'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> System<span class="token punctuation">.</span><span class="token function">import</span><span class="token punctuation">(</span><span class="token string">'vue'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> System<span class="token punctuation">.</span><span class="token function">import</span><span class="token punctuation">(</span><span class="token string">'vue-router'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">modules</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">var</span> singleSpa <span class="token operator">=</span> modules<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">var</span> Vue <span class="token operator">=</span> modules<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">var</span> VueRouter <span class="token operator">=</span> modules<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

      Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>VueRouter<span class="token punctuation">)</span>

      singleSpa<span class="token punctuation">.</span><span class="token function">registerApplication</span><span class="token punctuation">(</span>
        <span class="token string">'navbar'</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> System<span class="token punctuation">.</span><span class="token function">import</span><span class="token punctuation">(</span><span class="token string">'navbar'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token parameter">location</span> <span class="token operator">=&gt;</span> <span class="token boolean">true</span>
      <span class="token punctuation">)</span><span class="token punctuation">;</span>


      singleSpa<span class="token punctuation">.</span><span class="token function">registerApplication</span><span class="token punctuation">(</span>
        <span class="token string">'app1'</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> System<span class="token punctuation">.</span><span class="token function">import</span><span class="token punctuation">(</span><span class="token string">'app1'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token parameter">location</span> <span class="token operator">=&gt;</span> location<span class="token punctuation">.</span>pathname<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">'/app1'</span><span class="token punctuation">)</span>
      <span class="token punctuation">)</span>


      singleSpa<span class="token punctuation">.</span><span class="token function">registerApplication</span><span class="token punctuation">(</span>
        <span class="token string">'app2'</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> System<span class="token punctuation">.</span><span class="token function">import</span><span class="token punctuation">(</span><span class="token string">'app2'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token parameter">location</span> <span class="token operator">=&gt;</span> location<span class="token punctuation">.</span>pathname<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">'/app2'</span><span class="token punctuation">)</span>
      <span class="token punctuation">)</span>
    singleSpa<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><p><font color="red" size="3">æ³¨ï¼š ç”±äºSystem.import('xxx') è¿™ç§æ–¹å¼ï¼Œè·å¾—æ˜¯ä¸ªpromiseå¯¹è±¡ï¼Œæ‰€ä»¥æ£€æµ‹æ‰€éœ€æ¨¡å—æ˜¯å¦éƒ½å¼•å…¥å®Œå…¨ï¼Œä½¿ç”¨Promise.allæ–¹æ³•~</font></p> <p>è¿™é‡Œæ˜¯å¼•å…¥æ‰€æœ‰åº”ç”¨æ‰€éœ€çš„æ¨¡å—åï¼Œæ³¨å†Œsingle-spaåº”ç”¨ï¼Œ</p> <p><strong>registerApplication(name, howToLoad, activityFunction)</strong></p> <div class="language- extra-class"><pre><code>  name: ï¼ˆrequiredï¼‰,ä¸ºapplicationçš„name
  howToload: (required),æ˜¯ä¸€ä¸ªfunction ,è¡¨ç¤ºæ€æ ·åŠ è½½ï¼Œä¸Šè¿°ä»£ç æ˜¯é€šè¿‡System.importï¼Œ åŠ è½½å„ä¸ªé¡¹ç›®çš„å…¥å£jsæ–‡ä»¶ (æ¨¡å—åŠ è½½)
  activityFunction: (required) ä¹Ÿæ˜¯ä¸€ä¸ªfunction, å½“urlç¬¦åˆæ—¶ï¼Œè¿”å›true
</code></pre></div><p>æœ€åå†è¿›è¡ŒsingleSpa.start() è¿›è¡Œå¯åŠ¨</p> <p>å•¦å•¦å•¦~å®Œç»“æ’’èŠ± ğŸ˜ƒ</p> <p>é€šè¿‡å¯¹äºdemoçš„åˆ†æï¼Œæ›´å¥½çš„ç†è§£äº†single-spaçš„ä½¿ç”¨åœºæ™¯å’Œå¦‚ä½•è¿›è¡Œçš„ã€‚ä¸å¾—ä¸è¯´ï¼Œsingle-spaçš„è®¾è®¡å’Œæƒ³æ³•ï¼Œä»¤äººçœ¼ç•Œå¤§å¼€~å¸Œæœ›æœªæ¥æœ‰æœºä¼šä¹Ÿèƒ½åœ¨å¤§å‹å¤šä¸ªåº”ç”¨ä¸Šä¸€å±•èº«æ‰‹</p> <div class="language-diff line-numbers-mode"><pre class="language-diff"><code><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">åè®°ï¼š
</span></span></code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>åæ¥è‡ªå·±å‚è€ƒç½‘ä¸Šçš„å®ä¾‹ï¼Œå‚è€ƒç½‘ç«™ï¼š<a href="https://www.jdon.com/52552" target="_blank" rel="noopener noreferrer">react+vue single-spaå®æˆ˜<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>ä¹Ÿå†™äº†ä¸ªä»¥react, vueåˆ†åˆ«ä¸ºå•åº”ç”¨çš„ ç®€å•çš„single-spaï¼Œ ä¾‹å­è¯¦æˆ³ï¼š
<a href="https://github.com/wenwen1995/single-spa-test-demo" target="_blank" rel="noopener noreferrer">æ¨¡ä»¿çš„react+vue single-spaå®æˆ˜<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">7/7/2021, 2:20:19 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      â†
      <a href="/WJ-blog/front/introduction.html" class="prev">
        ä»‹ç»
      </a></span> <span class="next"><a href="/WJ-blog/front/study/typescript-about-interface-understand.html">
        TYPESCRIPT å…³äºinterfaceç†è§£
      </a>
      â†’
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/WJ-blog/assets/js/app.c05677e7.js" defer></script><script src="/WJ-blog/assets/js/2.505982ba.js" defer></script><script src="/WJ-blog/assets/js/12.44ae18c6.js" defer></script>
  </body>
</html>
